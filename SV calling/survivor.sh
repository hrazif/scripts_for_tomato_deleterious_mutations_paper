#!/bin/bash 

#nohup ./survivor.sh>>survivor.output&


manta_VCFs=/local/workdir/hr355/20191118_deleterious_alleles/20220425_SV_calling_LA2093_shortread/SV_calling/manta/manta_output_vcfs
delly_VCFs=/local/workdir/hr355/20191118_deleterious_alleles/20220425_SV_calling_LA2093_shortread/SV_calling/delly
lumpy_VCFs=/local/workdir/hr355/20191118_deleterious_alleles/20220425_SV_calling_LA2093_shortread/SV_calling/lumpy





#maybe I need to merge output from each software then merge them with survivor


#for i in "BGV004584" "BGV005895" "BGV005912" "BGV006148" "BGV006175" "BGV006208" "BGV006225" "BGV006229" "BGV006230" "BGV006231" "BGV006232" "BGV006234" "BGV006235" "BGV006327" "BGV006336" "BGV006347" "BGV006353" "BGV006363" "BGV006370" "BGV006454" "BGV006457" "BGV006478" "BGV006753" "BGV006767" "BGV006768" "BGV006775" "BGV006777" "BGV006779" "BGV006792" "BGV006806" "BGV006825" "BGV006828" "BGV006852" "BGV006859" "BGV006865" "BGV006867" "BGV006881" "BGV006896" "BGV006899" "BGV006901" "BGV006904" "BGV006906" "BGV006907" "BGV006910" "BGV006927" "BGV006931" "BGV006934" "BGV007015" "BGV007017" "BGV007023" "BGV007109" "BGV007111" "BGV007149" "BGV007151" "BGV007152" "BGV007158" "BGV007161" "BGV007169" "BGV007181" "BGV007194" "BGV007198" "BGV007339" "BGV007366" "BGV007854" "BGV007857" "BGV007860" "BGV007862" "BGV007863" "BGV007864" "BGV007865" "BGV007867" "BGV007870" "BGV007871" "BGV007872" "BGV007875" "BGV007876" "BGV007878" "BGV007894" "BGV007895" "BGV007899" "BGV007900" "BGV007901" "BGV007902" "BGV007908" "BGV007909" "BGV007910" "BGV007911" "BGV007918" "BGV007920" "BGV007921" "BGV007927" "BGV007931" "BGV007933" "BGV007934" "BGV007935" "BGV007936" "BGV007981" "BGV007989" "BGV007990" "BGV007992" "BGV008036" "BGV008037" "BGV008041" "BGV008051" "BGV008058" "BGV008065" "BGV008067" "BGV008070" "BGV008077" "BGV008095" "BGV008096" "BGV008098" "BGV008100" "BGV008106" "BGV008108" "BGV008189" "BGV008218" "BGV008219" "BGV008221" "BGV008223" "BGV008224" "BGV008225" "BGV008345" "BGV008348" "BGV008354" "BGV012613" "BGV012614" "BGV012615" "BGV012625" "BGV012626" "BGV012627" "BGV012639" "BGV012640" "BGV013134" "BGV013161" "BGV013175" "BGV013945" "BGV014508" "BGV014514" "BGV014515" "BGV014516" "BGV014518" "BGV014519" "BGV014522" "BGV015380" "BGV015382" "BGV015726" "BGV015727" "BGV015730" "BGV015734" "EA00157" "EA00325" "EA00371" "EA00465" "EA00585" "EA00676" "EA00892" "EA00940" "EA00990" "EA01019" "EA01049" "EA01155" "EA01640" "EA01835" "EA02617" "EA02655" "EA02724" "EA03221" "EA03362" "EA03701" "EA04243" "EA04828" "EA04939" "EA05170" "EA05701" "EA06086" "LA0767" "LA1712" "LA2309" "LA2697" "PAS014479" "PI129026" "PI129033" "PI129088" "PI378994" "PI406890" "PI487625" "Tegucigalpa" "TR00003" "TR00018" "TR00019" "TR00020" "TR00021" "TR00022" "TR00023" "TR00026" "TR00027" "TR00028" "TS-10" "TS-129" "TS-131" "TS-132" "TS-137" "TS-139" "TS-140" "TS-141" "TS-142" "TS-148" "TS-152" "TS-154" "TS-156" "TS-158" "TS-163" "TS-165" "TS-173" "TS-184" "TS-191" "TS-192" "TS-193" "TS-197" "TS-201" "TS-203" "TS-229" "TS-231" "TS-242" "TS-247" "TS-249" "TS-251" "TS-258" "TS-261" "TS-273" "TS-280" "TS-282" "TS-299" "TS-304" "TS-41" "TS-411" "TS-413" "TS-415" "TS-416" "TS-417" "TS-419" "TS-420" "TS-421" "TS-422" "TS-425" "TS-429" "TS-43" "TS-434" "TS-435" "TS-436" "TS-438" "TS-439" "TS-44" "TS-53" "TS-56" "TS-57" "TS-73" "TS-75" "TS-77" "TS-79" "TS-86" "TS-95" "Voyage"; do

for i in SRR12039813; do	
	#list of input files
	 ls $manta_VCFs/"$i".vcf.gz $delly_VCFs/"$i".vcf $lumpy_VCFs/"$i".vcf  > sample_files

	#This will merge all the vcf files specified in sample_files together using a maximum allowed distance of 1kb, as measured pairwise between breakpoints (begin1 vs begin2, end1 vs end2). Furthermore we ask SURVIVOR only to report calls supported by 2 callers and they have to agree on the type (1) and on the strand (1) of the SV. Note you can change this behavior by altering the numbers from 1 to e.g. 0. In addition, we told SURVIVOR to only compare SV that are at least 30bp long and print the output in sample_merged.vcf.

	 ~/Software/SURVIVOR-master/Debug/SURVIVOR merge sample_files 1000 2 1 1 0 30 "$i".vcf

done
 

#to simplify the VCFs 
#@!for i in "BGV004584" "BGV005895" "BGV005912" "BGV006148" "BGV006175" "BGV006208" "BGV006225" "BGV006229" "BGV006230" "BGV006231" "BGV006232" "BGV006234" "BGV006235" "BGV006327" "BGV006336" "BGV006347" "BGV006353" "BGV006363" "BGV006370" "BGV006454" "BGV006457" "BGV006478" "BGV006753" "BGV006767" "BGV006768" "BGV006775" "BGV006777" "BGV006779" "BGV006792" "BGV006806" "BGV006825" "BGV006828" "BGV006852" "BGV006859" "BGV006865" "BGV006867" "BGV006881" "BGV006896" "BGV006899" "BGV006901" "BGV006904" "BGV006906" "BGV006907" "BGV006910" "BGV006927" "BGV006931" "BGV006934" "BGV007015" "BGV007017" "BGV007023" "BGV007109" "BGV007111" "BGV007149" "BGV007151" "BGV007152" "BGV007158" "BGV007161" "BGV007169" "BGV007181" "BGV007194" "BGV007198" "BGV007339" "BGV007366" "BGV007854" "BGV007857" "BGV007860" "BGV007862" "BGV007863" "BGV007864" "BGV007865" "BGV007867" "BGV007870" "BGV007871" "BGV007872" "BGV007875" "BGV007876" "BGV007878" "BGV007894" "BGV007895" "BGV007899" "BGV007900" "BGV007901" "BGV007902" "BGV007908" "BGV007909" "BGV007910" "BGV007911" "BGV007918" "BGV007920" "BGV007921" "BGV007927" "BGV007931" "BGV007933" "BGV007934" "BGV007935" "BGV007936" "BGV007981" "BGV007989" "BGV007990" "BGV007992" "BGV008036" "BGV008037" "BGV008041" "BGV008051" "BGV008058" "BGV008065" "BGV008067" "BGV008070" "BGV008077" "BGV008095" "BGV008096" "BGV008098" "BGV008100" "BGV008106" "BGV008108" "BGV008189" "BGV008218" "BGV008219" "BGV008221" "BGV008223" "BGV008224" "BGV008225" "BGV008345" "BGV008348" "BGV008354" "BGV012613" "BGV012614" "BGV012615" "BGV012625" "BGV012626" "BGV012627" "BGV012639" "BGV012640" "BGV013134" "BGV013161" "BGV013175" "BGV013945" "BGV014508" "BGV014514" "BGV014515" "BGV014516" "BGV014518" "BGV014519" "BGV014522" "BGV015380" "BGV015382" "BGV015726" "BGV015727" "BGV015730" "BGV015734" "EA00157" "EA00325" "EA00371" "EA00465" "EA00585" "EA00676" "EA00892" "EA00940" "EA00990" "EA01019" "EA01049" "EA01155" "EA01640" "EA01835" "EA02617" "EA02655" "EA02724" "EA03221" "EA03362" "EA03701" "EA04243" "EA04828" "EA04939" "EA05170" "EA05701" "EA06086" "LA0767" "LA1712" "LA2309" "LA2697" "PAS014479" "PI129026" "PI129033" "PI129088" "PI378994" "PI406890" "PI487625" "Tegucigalpa" "TR00003" "TR00018" "TR00019" "TR00020" "TR00021" "TR00022" "TR00023" "TR00026" "TR00027" "TR00028" "TS-10" "TS-129" "TS-131" "TS-132" "TS-137" "TS-139" "TS-140" "TS-141" "TS-142" "TS-148" "TS-152" "TS-154" "TS-156" "TS-158" "TS-163" "TS-165" "TS-173" "TS-184" "TS-191" "TS-192" "TS-193" "TS-197" "TS-201" "TS-203" "TS-229" "TS-231" "TS-242" "TS-247" "TS-249" "TS-251" "TS-258" "TS-261" "TS-273" "TS-280" "TS-282" "TS-299" "TS-304" "TS-41" "TS-411" "TS-413" "TS-415" "TS-416" "TS-417" "TS-419" "TS-420" "TS-421" "TS-422" "TS-425" "TS-429" "TS-43" "TS-434" "TS-435" "TS-436" "TS-438" "TS-439" "TS-44" "TS-53" "TS-56" "TS-57" "TS-73" "TS-75" "TS-77" "TS-79" "TS-86" "TS-95" "Voyage"; do
 
#@!grep -v '#' "$i".vcf|grep -v 'SL2.50ch00'|cut -f1,2,6,8,10 > temp1
#@!cut -f4 temp1|tr ';' '\t'|cut -f3,4,10 > temp2
#@!cut -f5 temp1|tr ':' '\t'|cut -f1 > temp3
#@!cut -f1,2,3 temp1 > temp4

#@!paste temp4 temp2 temp3|sed 's/'SVLEN='//g'|sed 's/'SVTYPE='//g'|sed 's/'STRANDS='//g' > temp5

#make a header file ("nano header.txt"), then do this
#@!cat header.txt temp5 > "$i"_simple.txt

#@!done





 
 
 
 
 
